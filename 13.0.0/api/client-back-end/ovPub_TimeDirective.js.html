<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: ovPub/TimeDirective.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: ovPub/TimeDirective.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

(function(app) {

  /**
   * Time directive
   *
   * Provide a new HTML element ovp-time. This element will create three input (hours, minutes and
   * seconds) for selecting time. Theese inputs will be joined in a single string (hh:mm:ss) to set
   * the viewValue and will be converted in milliseconds for the modelValue.
   *
   * The attribute milliseconds-max must be set to validate the value range.
   *
   * @class ovpTime
   * @memberof module:ov.publish
   * @inner
   */
  function ovpTime($filter) {
    return {
      restrict: 'E',
      require: ['?ngModel'],
      replace: true,
      templateUrl: 'ov-publish-time.html',
      scope: {},
      link: function(scope, el, attrs, controllers) {
        var ngModelCtrl = controllers[0];
        var time;

        // Convert one digit integer to two chars string (ex: 2 to '02')
        var pad = function(value) {
          return ('0' + value).slice(-2);
        };

        // Convert viewValue to modelValue (hh:mm:ss to ms)
        ngModelCtrl.$parsers.push($filter('timeToMilliseconds'));

        // Convert modelValue to viewValue (ms to hh:mm:ss)
        ngModelCtrl.$formatters.push($filter('millisecondsToTime'));

        ngModelCtrl.$render = function() {
          if (undefined === ngModelCtrl.$viewValue) {
            return;
          }

          var matches = ngModelCtrl.$viewValue.match(/^([0-9]{2}):([0-5][0-9]):([0-5][0-9])$/);

          if (null === matches) {
            return;
          }

          scope.hours = matches[1];
          scope.minutes = matches[2];
          scope.seconds = matches[3];
        };

        /**
         * notEmpty Constraints
         *
         * If the parser can't convert the viewValue, the modelValue be undefined.
         */
        ngModelCtrl.$validators.notEmpty = function(modelValue, viewValue) {
          return modelValue !== undefined;
        };

        /**
         * range Constraints
         *
         * The model value must be greater or equals to zero and can't exceed
         * the max value setted in the attributes.
         */
        ngModelCtrl.$validators.range = function(modelValue, viewValue) {
          return modelValue >= 0 &amp;&amp; modelValue &lt;= attrs.millisecondsMax;
        };

        /**
         * Set the viewValue on change events
         */
        scope.updateTime = function() {
          time = pad(scope.hours) + ':' + pad(scope.minutes) + ':' + pad(scope.seconds);

          ngModelCtrl.$setViewValue(time);
        };

        /**
         * Add zero below the input's value to match the two digits string pattern
         * on blur event.
         */
        scope.formatInputs = function() {
          if (ngModelCtrl.$valid) {
            scope.hours = pad(scope.hours);
            scope.minutes = pad(scope.minutes);
            scope.seconds = pad(scope.seconds);
          }
        };
      }
    };
  }

  app.directive('ovpTime', ovpTime);
  ovpTime.$inject = ['$filter'];

})(angular.module('ov.publish'));
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="ov.module_publish.html">ov.publish</a></li><li><a href="ov.module_publish_multirange.html">ov.publish/multirange</a></li></ul><h3>Classes</h3><ul><li><a href="module-ov.publish-MillisecondsToTime.html">ov.publish~MillisecondsToTime</a></li><li><a href="module-ov.publish-ovpTime.html">ov.publish~ovpTime</a></li><li><a href="module-ov.publish-PublishService.html">ov.publish~PublishService</a></li><li><a href="module-ov.publish-TimeToMilliseconds.html">ov.publish~TimeToMilliseconds</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Fri Mar 11 2022 07:52:09 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
